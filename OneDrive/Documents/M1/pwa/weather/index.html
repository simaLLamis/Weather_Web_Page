<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Weather App</title>
    <link rel="stylesheet" href="styles.css"></head>
<body>
    <div class="app">
        <div class="weather-container">
            <div class="current-weather">
                <h2 id="city-name"></h2>
                <p id="current-date"></p> <!-- Display current date -->
                <p id="current-time"></p> <!-- Display current time -->
                <div class="weather-icon">
                    <img id="weather-icon" alt="Weather Icon">
                </div>
                <h1 id="temperature">13°</h1>
                <p id="condition"></p>
            </div>
            
            <div class="details-container">
                <div class="details">
                    <h3>Precipitation</h3>
                    <p id="precipitation"></p>
                </div>
                <div class="details">
                    <h3>Wind</h3>
                    <p id="wind-speed"></p>
                </div>
                <div class="details">
                    <h3>Humidity</h3>
                    <p id="humidity"></p>
                </div>
                <div class="details">
                    <h3>Pressure</h3>
                    <p id="pressure"></p>
                </div>
            </div>
        </div>
        
        <div class="city-search">
            <input type="text" id="search-input" placeholder="Search for city...">
            <button id="search-button">Search</button>
        </div>
    </div>

    <script>
        const apiKey = '58e6d9f187fc7b5c5b00288a4d7ad65f'; // Replace with your OpenWeatherMap API key
        const apiUrl = 'https://api.openweathermap.org/data/2.5/weather?units=metric&';

        // DOM Elements
        const cityName = document.getElementById('city-name');
        const weatherIcon = document.getElementById('weather-icon');
        const temperature = document.getElementById('temperature');
        const condition = document.getElementById('condition');
        const precipitation = document.getElementById('precipitation');
        const windSpeed = document.getElementById('wind-speed');
        const humidity = document.getElementById('humidity');
        const pressure = document.getElementById('pressure');
        const searchInput = document.getElementById('search-input');
        const searchButton = document.getElementById('search-button');

        // Function to update the time
        function updateTime() {
            const now = new Date();//Obtenir l'heure actuelle
            const options = { hour: '2-digit', minute: '2-digit', second: '2-digit', hour12: false };//Définir les options de formatage
            const timeString = now.toLocaleTimeString([], options);
            document.getElementById('current-time').textContent = timeString;
        }

        // Function to update the date
        function updateDate() {
            const now = new Date();// Récupère la date actuelle
            const options = { day: '2-digit', month: '2-digit', year: 'numeric' };// Définit le format
            const dateString = now.toLocaleDateString('en-GB', options); // Format as DD/MM/YYYY
            document.getElementById('current-date').textContent = dateString;// Met à jour l'élément HTML pour afficher la date
        }

        // Function to fetch weather data
        async function fetchWeather(city) {
            try {
                const response = await fetch(`${apiUrl}q=${city}&appid=${apiKey}`);// Effectue une requête API pour une ville donnée
                const data = await response.json();// Convertit la réponse en JSON

                if (data.cod !== 200) {// Vérifie si le code de réponse indique une erreur
                    alert('City not found');// Informe l'utilisateur si la ville n'est pas valide
                    return;
                }

                cityName.textContent = `${data.name}, ${data.sys.country}`;// Affiche le nom de la ville et le pays
                temperature.textContent = `${Math.round(data.main.temp)}°`;// Affiche la température actuelle
                condition.textContent = data.weather[0].description;// Affiche une description des conditions météo

                // Weather icon
                const iconCode = data.weather[0].icon;
                weatherIcon.src = `https://openweathermap.org/img/wn/${iconCode}@2x.png`;

                // Details
                precipitation.textContent = `${data.clouds.all}%`;
                windSpeed.textContent = `${data.wind.speed} km/h`;
                humidity.textContent = `${data.main.humidity}%`;
                pressure.textContent = `${data.main.pressure} hPa`;

            } catch (error) {
                console.error('Error fetching weather data:', error);
            }
        }

        // Event listener for search button
        searchButton.addEventListener('click', () => {
            const city = searchInput.value.trim();
            if (city) {
                fetchWeather(city);
            } else {
                alert('Please enter a city name');
            }
        });

        // Call updateDate and updateTime immediately to set the initial values
        updateDate();
        updateTime();

        // Update time every minute
        setInterval(updateTime, 60000);

        // Fetch initial weather for Algeria
        fetchWeather('Algeria');
    </script>
</body>
</html>